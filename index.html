<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Home</title>
</head>
<body>

<form method="post" action="/devices">
    <label>
        Name:
        <input name="name" type="text" required />
    </label>

    <br>

    <label>
        Description:
        <textarea name="description" required></textarea>
    </label>

    <br>

    <label>
        Type:
        <select name="type" required>
            <option value="relay">Relay</option>
            <option value="temperature">Temperature</option>
            <option value="humidity">Humidity</option>
        </select>
    </label>

    <br>

    <label>
        Pin:
        <input name="pin" type="text" required />
    </label>

    <br>

    <input type="submit" />
</form>

</body>

<script src="/socket.io/socket.io.js"></script>
<script src="https://code.jquery.com/jquery-1.11.1.js"></script>
<!--<script src="/app.jsx"></script>-->
<script>
  $(function () {
    const socket = io();
    let counter = 0;
    let timer;

    function clock() {
      counter += 1;


      // 1Kw/h = 0.795
      const cost = (counter * 0.01325).toFixed(2);
      $('#timer').text(`Time: ${counter} seconds`);
      $('#cost').text(`Cost: $${cost}`);

      timer = setTimeout(clock, 1000);
    }

    $('#relay').change(function() {
      const status = $(this).is(':checked') ? 'ON' : 'OFF';
      socket.emit('relay', status);

//      counter = 0;
      clearTimeout(timer);

      if ($(this).is(':checked')) {
        clock()
      }

      return false;
    });

  });
</script>
</html>